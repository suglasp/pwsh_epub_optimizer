
PowerShell epub EBook optimizer

Script that can read a epub file and try to compress the images a bit more, so the total epub file gets smaller.

! Does not work on epub files containing .gif, .svg and .png files.   !
! Only epub files containing .jp(e)g images are supported.            !

Usage:
.\epub_ebook_optimizer.ps1 <path\myebookfile.epub>  # single argument is the same as providing arg -epub <path\myebookfile.epub>
.\epub_ebook_optimizer.ps1 -epub <path\myebookfile.epub> [-limit <size as bytes>] [-compression <0..100 as procent>]


Version History:
14/11/2021 : First versions.
             Made a few tweaks to it in the same day.
             Last version was in fact non-working, because i commented out the Optimization method for debugging reasons, and forgot te re-enable the method when pushed to repo.
15/11/2021 : Created a more optimized and efficiÃ«nt version (not in terms of speed, but in optimizing the end result epub file).


Tips & tricks:
- Loop trough a folder and optimize epub files in bulk
PS C:\epub_tool> $files = @(Get-ChildItem -Path C:\SomePathWithFiles -Filter *.epub)
PS C:\epub_tool> $files | % { .\epub_ebook_optimizer.ps1 $_.FullName }

- The script shows "WARNING: [!] No epub action needed! Size is okay."
Always check you use absolute paths instead of relative paths.
For example, dot sourced paths in Powershell will not work.
PS C:\epub_tool> .\epub_ebook_optimizer.ps1 .\MyEBookFile.epub                # will not work
PS C:\epub_tool> .\epub_ebook_optimizer.ps1 "C:\epub_tool\MyEBookFile.epub"   # does work
